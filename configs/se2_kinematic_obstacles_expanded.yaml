seed: 7
device: cuda

model:
  history_window: 16
  segment_len: 16
  mem_len: 32
  max_history_tokens: 64
  kv_cache_max_tokens: 64
  transformer:
    d_model: 128
    n_heads: 4
    d_inner: 256
    dropout: 0.1
    mem_len: 32
    n_layers: 3
  waypoint_sequence_len: 1
  waypoint_dim: 2
  include_prev_action: false
  actor:
    input_dim: 6
    include_prev_action: false
    waypoint_dim: 2
    waypoint_sequence_len: 1
    use_waypoint_as_ref: true
    transformer:
      d_model: 128
      n_heads: 4
      d_inner: 256
      dropout: 0.1
      mem_len: 32
      n_layers: 3
    mpc:
      horizon: 5
      state_dim: 6
      action_dim: 3
      dt: 0.05
      latent_dim: 128
      device: cuda
      max_iter: 15
      tol_x: 1.0e-4
    cost_map:
      hidden_dim: 512
      num_layers: 2
      dropout: 0.0
  critic:
    input_dim: 6
    include_prev_action: false
    waypoint_dim: 2
    waypoint_sequence_len: 1
    include_lidar: true
    lidar_dim: 108
    transformer:
      d_model: 128
      n_heads: 4
      d_inner: 256
      dropout: 0.1
      mem_len: 32
      n_layers: 3
  include_lidar: true
  lidar_dim: 108
  include_prev_action: false
  history_window: 16

sampler:
  num_envs: 8
  rollout_steps: 400
  episode_len: 400
  seed_offset: 0

training:
  device: cuda
  actor_lr: 1.5e-4
  critic_lr: 7.5e-5
  weight_decay: 0.0
  clip_param: 0.12
  entropy_coeff: 0.001
  value_loss_coeff: 0.5
  max_grad_norm: 1.0
  ppo_epochs: 4
  mini_batch_size: 256
  target_kl: 0.02
  normalize_lidar: true
  log_interval: 10
  log_to_stdout: true
  checkpoint_interval: 1
  checkpoint_keep_last: 3
  checkpoint_metric: episode_reward
  checkpoint_mode: max
  lr_schedule: linear
  lr_warmup_steps: 0
  lr_decay_steps: 200
